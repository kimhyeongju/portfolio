<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>MY Assistant</title>
    <meta name="description" content="HYEONGJUì™€ IT ê¸°ìˆ ì— ëŒ€í•´ ì§ˆë¬¸í•´ë³´ì„¸ìš”!" />
    <meta name="keywords" content="AI, ì±—ë´‡, í¬íŠ¸í´ë¦¬ì˜¤, HYEONGJU" />

    <!-- Favicons -->
    <link href="/img/favicon.png" rel="icon" />
    <link href="/img/apple-touch-icon.png" rel="apple-touch-icon" />

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet" />

    <!-- Vendor CSS Files -->
    <link href="/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet" />
    <link href="/vendor/aos/aos.css" rel="stylesheet" />
    <link href="/vendor/swiper/swiper-bundle.min.css" rel="stylesheet" />
    <link href="/vendor/glightbox/css/glightbox.min.css" rel="stylesheet" />

    <!-- Main CSS File -->
    <link href="/css/main.css" rel="stylesheet" />
</head>

<body class="chatbot-page">
    <!-- Header -->
    <header id="header" class="header d-flex align-items-center light-background sticky-top">
        <div class="container-fluid position-relative d-flex align-items-center justify-content-between">
            <a href="/index" class="logo d-flex align-items-center me-auto me-xl-0">
                <h1 class="sitename">HYEONGJU</h1>
            </a>

            <nav id="navmenu" class="navmenu">
                <ul>
                    <li><a href="/index">Home</a></li>
                    <li><a href="/about">About</a></li>
                    <li><a href="/resume">Resume</a></li>
                    <li><a href="/projects">Projects</a></li>
                    <li><a href="/service">Service</a></li>
                    <li><a href="/chatbot" class="active">ğŸ—¨Chat</a></li>
                </ul>
                <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
            </nav>
        </div>
    </header>

    <main class="main">
        <!-- AI ì±—ë´‡ Section -->
        <section id="chatbot" class="chatbot section">
            <!-- Section Title -->
            <div class="container section-title" data-aos="fade-up">
                <h2>í˜•ì£¼(HYEONGJU)ì˜ AssistantğŸ’¦</h2>
                <p>HYEONGJUì— ëŒ€í•´ ê¶ê¸ˆí•œ ì ì— ëŒ€í•´ ì§ˆë¬¸í•´ë³´ì„¸ìš”!</p>
                <p>â—í…ŒìŠ¤íŠ¸ìš©ìœ¼ë¡œ ë‹µë³€ì´ ì˜ëª»ë˜ê±°ë‚˜ ê³¼ì¥ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
            </div>
            <!-- End Section Title -->

            <div class="container" data-aos="fade-up" data-aos-delay="100">
                <div class="row justify-content-center">
                    <div class="col-lg-10">
                        <div class="chatbot-container">
                            <!-- ì±—ë´‡ í—¤ë” -->
                            <div class="chatbot-header">
                                <div class="d-flex align-items-center">
                                    <div class="chatbot-avatar">
                                        <i class="bi bi-robot"></i>
                                    </div>
                                    <div class="chatbot-info">
                                        <h5 class="mb-0">âŒë©€í‹°í„´ ëŒ€í™” ë¹„í™œì„±í™”</h5>
                                        <small class="status-text">
                                            <span class="status-indicator"></span>
                                            ì˜¨ë¼ì¸
                                        </small>
                                    </div>
                                </div>
                            </div>

                            <!-- ì±—ë´‡ ë©”ì‹œì§€ ì˜ì—­ -->
                            <div class="chatbot-messages" id="chatMessages">
                                <div class="welcome-section">
                                    <div class="welcome-avatar">
                                        <i class="bi bi-robot"></i>
                                    </div>
                                    <div class="welcome-content">
                                        <h6>ì•ˆë…•í•˜ì„¸ìš”! ğŸ‘‹</h6>
                                        <p class="mb-2">HYEONGJUì˜ AI ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤.</p>
                                        <div class="suggestion-chips">
                                            <span class="chip" onclick="sendSuggestion('ê¹€í˜•ì£¼ì— ëŒ€í•´ ê°„ë‹¨íˆ ì†Œê°œí•´ì£¼ì„¸ìš”')">
                                                <i class="bi bi-person-circle"></i> HYEONGJU ì†Œê°œ
                                            </span>
                                            <span class="chip" onclick="sendSuggestion('ê¹€í˜•ì£¼ì˜ ê¸°ìˆ  ìŠ¤íƒì„ ì•Œë ¤ì£¼ì„¸ìš”')">
                                                <i class="bi bi-code-slash"></i> ê¸°ìˆ  ìŠ¤íƒ
                                            </span>
                                            <span class="chip" onclick="sendSuggestion('ê¹€í˜•ì£¼ê°€ í•œ í”„ë¡œì íŠ¸ì— ëŒ€í•´ ì•Œë ¤ì£¼ì„¸ìš”')">
                                                <i class="bi bi-briefcase"></i> í”„ë¡œì íŠ¸
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- íƒ€ì´í•‘ í‘œì‹œ -->
                            <div class="typing-indicator" id="typingIndicator">
                                <div class="typing-dots">
                                    <span></span>
                                    <span></span>
                                    <span></span>
                                </div>
                                <span class="typing-text">AIê°€ ì‘ë‹µì„ ì¤€ë¹„í•˜ê³  ìˆìŠµë‹ˆë‹¤...</span>
                            </div>

                            <!-- ì…ë ¥ ì˜ì—­ -->
                            <div class="chatbot-input">
                                <div class="input-group">
                                    <input type="text" class="form-control" id="messageInput" 
                                           placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." 
                                           maxlength="500" />
                                    <button class="btn btn-primary" id="sendButton" onclick="sendMessage()">
                                        <i class="bi bi-send"></i>
                                    </button>
                                </div>
                                <div class="input-footer">
                                    <small class="text-muted">
                                        <i class="bi bi-shield-check"></i>
                                        ì•ˆì „í•˜ê³  ê°œì¸ì •ë³´ë¥¼ ë³´í˜¸í•˜ëŠ” ëŒ€í™”
                                    </small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- /AI ì±—ë´‡ Section -->
    </main>

    <!-- Footer -->
    <footer id="footer" class="footer light-background">
        <div class="container">
            <div class="credits">
                Designed by <a href="https://bootstrapmade.com/">BootstrapMade</a> Distributed by
                <a href="https://themewagon.com">ThemeWagon</a>
            </div>
        </div>
    </footer>

    <!-- Scroll Top -->
    <a href="#" id="scroll-top" class="scroll-top d-flex align-items-center justify-content-center">
        <i class="bi bi-arrow-up-short"></i>
    </a>

    <!-- Preloader -->
    <div id="preloader"></div>

    <!-- Vendor JS Files -->
    <script src="/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="/vendor/php-email-form/validate.js"></script>
    <script src="/vendor/aos/aos.js"></script>
    <script src="/vendor/waypoints/noframework.waypoints.js"></script>
    <script src="/vendor/purecounter/purecounter_vanilla.js"></script>
    <script src="/vendor/swiper/swiper-bundle.min.js"></script>
    <script src="/vendor/glightbox/js/glightbox.min.js"></script>
    <script src="/vendor/imagesloaded/imagesloaded.pkgd.min.js"></script>
    <script src="/vendor/isotope-layout/isotope.pkgd.min.js"></script>

    <!-- Main JS File -->
    <script src="/js/main.js"></script>


    <!-- Chatbot JavaScript -->
    <script>
        const chatMessages = document.getElementById('chatMessages');
        const messageInput = document.getElementById('messageInput');
        const sendButton = document.getElementById('sendButton');
        const typingIndicator = document.getElementById('typingIndicator');

        // Enter í‚¤ë¡œ ë©”ì‹œì§€ ì „ì†¡
        messageInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        // ì²« ë©”ì‹œì§€ ì „ì†¡ ì‹œ ì›°ì»´ ì„¹ì…˜ ìˆ¨ê¸°ê¸°
        let isFirstMessage = true;

        async function sendMessage() {
            const message = messageInput.value.trim();
            if (!message || sendButton.disabled) return;

            // ì²« ë©”ì‹œì§€ì¸ ê²½ìš° ì›°ì»´ ì„¹ì…˜ ìˆ¨ê¸°ê¸°
            if (isFirstMessage) {
                document.querySelector('.welcome-section').style.display = 'none';
                isFirstMessage = false;
            }

            // ì‚¬ìš©ì ë©”ì‹œì§€ ì¶”ê°€
            addMessage(message, 'user');
            messageInput.value = '';
            
            // ë²„íŠ¼ ë¹„í™œì„±í™” ë° íƒ€ì´í•‘ í‘œì‹œ
            sendButton.disabled = true;
            showTypingIndicator();

            try {
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ message: message })
                });

                const data = await response.json();
                
                hideTypingIndicator();
                
                if (data.status === 'success') {
                    await addMessageWithTyping(data.response, 'bot');
                } else {
                    await addMessageWithTyping('ì£„ì†¡í•©ë‹ˆë‹¤. ì¼ì‹œì ì¸ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.', 'bot');
                }
            } catch (error) {
                console.error('Error:', error);
                hideTypingIndicator();
                await addMessageWithTyping('ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì¸í„°ë„· ì—°ê²°ì„ í™•ì¸í•´ ì£¼ì„¸ìš”.', 'bot');
            } finally {
                sendButton.disabled = false;
                messageInput.focus();
            }
        }

        function addMessage(text, sender) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            
            let messageContent = '';
            if (sender === 'bot') {
                messageContent = `
                    <div class="message-avatar">
                        <i class="bi bi-robot"></i>
                    </div>
                    <div class="message-content">${text}</div>
                `;
            } else {
                messageContent = `<div class="message-content">${text}</div>`;
            }
            
            messageDiv.innerHTML = messageContent;
            chatMessages.appendChild(messageDiv);
            scrollToBottom();
        }

        async function addMessageWithTyping(text, sender) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            
            let messageContent = '';
            if (sender === 'bot') {
                messageContent = `
                    <div class="message-avatar">
                        <i class="bi bi-robot"></i>
                    </div>
                    <div class="message-content typing-effect"></div>
                `;
            } else {
                messageContent = `<div class="message-content typing-effect"></div>`;
            }
            
            messageDiv.innerHTML = messageContent;
            chatMessages.appendChild(messageDiv);
            scrollToBottom();

            const contentDiv = messageDiv.querySelector('.message-content');
            
            // íƒ€ì´í•‘ íš¨ê³¼
            await typeText(contentDiv, text);
            
            // íƒ€ì´í•‘ ì™„ë£Œ í›„ ì»¤ì„œ ì œê±°
            contentDiv.classList.remove('typing-effect');
        }

        function typeText(element, text, speed = 30) {
            return new Promise((resolve) => {
                let index = 0;
                element.textContent = '';
                
                function addChar() {
                    if (index < text.length) {
                        element.textContent += text.charAt(index);
                        index++;
                        scrollToBottom();
                        setTimeout(addChar, speed);
                    } else {
                        resolve();
                    }
                }
                
                addChar();
            });
        }

        function showTypingIndicator() {
            typingIndicator.style.display = 'flex';
            scrollToBottom();
        }

        function hideTypingIndicator() {
            typingIndicator.style.display = 'none';
        }

        function scrollToBottom() {
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function sendSuggestion(suggestion) {
            messageInput.value = suggestion;
            sendMessage();
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì…ë ¥ì°½ì— í¬ì»¤ìŠ¤
        window.addEventListener('load', function() {
            messageInput.focus();
        });
    </script>
</body>
</html>